{"version":3,"file":"static/js/4738.7fbe3e07.chunk.js","mappings":"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","sources":["screens/Console/Buckets/BucketDetails/AccessDetailsPanel.tsx","screens/Console/Common/PanelTitle/PanelTitle.tsx","screens/shared/tabs.tsx"],"sourcesContent":["// This file is part of MinIO Console Server\n// Copyright (c) 2021 MinIO, Inc.\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU Affero General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU Affero General Public License for more details.\n//\n// You should have received a copy of the GNU Affero General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport React, { Fragment, useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport { Paper } from \"@mui/material\";\nimport Tabs from \"@mui/material/Tabs\";\nimport Tab from \"@mui/material/Tab\";\nimport { AppState } from \"../../../../store\";\nimport { setErrorSnackMessage } from \"../../../../actions\";\nimport { TabPanel } from \"../../../shared/tabs\";\nimport { Policy } from \"../../Policies/types\";\nimport { ISessionResponse } from \"../../types\";\nimport { User } from \"../../Users/types\";\nimport { ErrorResponseHandler } from \"../../../../common/types\";\nimport TableWrapper from \"../../Common/TableWrapper/TableWrapper\";\nimport api from \"../../../../common/api\";\nimport history from \"../../../../history\";\nimport { BucketInfo } from \"../types\";\nimport {\n  CONSOLE_UI_RESOURCE,\n  IAM_PAGES,\n  IAM_SCOPES,\n} from \"../../../../common/SecureComponent/permissions\";\nimport PanelTitle from \"../../Common/PanelTitle/PanelTitle\";\nimport {\n  SecureComponent,\n  hasPermission,\n} from \"../../../../common/SecureComponent\";\nimport { Theme } from \"@mui/material/styles\";\nimport createStyles from \"@mui/styles/createStyles\";\nimport { tableStyles } from \"../../Common/FormComponents/common/styleLibrary\";\nimport withStyles from \"@mui/styles/withStyles\";\n\nconst mapState = (state: AppState) => ({\n  session: state.console.session,\n  loadingBucket: state.buckets.bucketDetails.loadingBucket,\n  bucketInfo: state.buckets.bucketDetails.bucketInfo,\n});\n\nconst connector = connect(mapState, { setErrorSnackMessage });\n\nfunction a11yProps(index: any) {\n  return {\n    id: `simple-tab-${index}`,\n    \"aria-controls\": `simple-tabpanel-${index}`,\n  };\n}\n\ninterface IAccessDetailsProps {\n  session: ISessionResponse;\n  setErrorSnackMessage: typeof setErrorSnackMessage;\n  classes: any;\n  match: any;\n  loadingBucket: boolean;\n  bucketInfo: BucketInfo | null;\n}\n\nconst styles = (theme: Theme) =>\n  createStyles({\n    ...tableStyles,\n  });\nconst AccessDetails = ({\n  match,\n  setErrorSnackMessage,\n  loadingBucket,\n  classes,\n}: IAccessDetailsProps) => {\n  const [curTab, setCurTab] = useState<number>(0);\n  const [loadingPolicies, setLoadingPolicies] = useState<boolean>(true);\n  const [bucketPolicy, setBucketPolicy] = useState<Policy[]>([]);\n  const [loadingUsers, setLoadingUsers] = useState<boolean>(true);\n  const [bucketUsers, setBucketUsers] = useState<User[]>([]);\n\n  const bucketName = match.params[\"bucketName\"];\n\n  const displayPoliciesList = hasPermission(bucketName, [\n    IAM_SCOPES.ADMIN_LIST_USER_POLICIES,\n  ]);\n\n  const displayUsersList = hasPermission(\n    bucketName,\n    [\n      IAM_SCOPES.ADMIN_GET_POLICY,\n      IAM_SCOPES.ADMIN_LIST_USERS,\n      IAM_SCOPES.ADMIN_LIST_GROUPS,\n    ],\n    true\n  );\n\n  const viewUser = hasPermission(CONSOLE_UI_RESOURCE, [\n    IAM_SCOPES.ADMIN_GET_USER,\n  ]);\n  const viewPolicy = hasPermission(CONSOLE_UI_RESOURCE, [\n    IAM_SCOPES.ADMIN_GET_POLICY,\n    IAM_SCOPES.ADMIN_LIST_USERS,\n    IAM_SCOPES.ADMIN_LIST_GROUPS,\n  ]);\n\n  useEffect(() => {\n    if (loadingBucket) {\n      setLoadingUsers(true);\n      setLoadingPolicies(true);\n    }\n  }, [loadingBucket, setLoadingUsers, setLoadingPolicies]);\n\n  const PolicyActions = [\n    {\n      type: \"view\",\n      disableButtonFunction: () => !viewPolicy,\n      onClick: (policy: any) => {\n        history.push(`${IAM_PAGES.POLICIES}/${policy.name}`);\n      },\n    },\n  ];\n\n  const userTableActions = [\n    {\n      type: \"view\",\n      disableButtonFunction: () => !viewUser,\n      onClick: (user: any) => {\n        history.push(`${IAM_PAGES.USERS}/${user}`);\n      },\n    },\n  ];\n\n  useEffect(() => {\n    if (loadingUsers) {\n      if (displayUsersList) {\n        api\n          .invoke(\"GET\", `/api/v1/bucket-users/${bucketName}`)\n          .then((res: any) => {\n            setBucketUsers(res);\n            setLoadingUsers(false);\n          })\n          .catch((err: ErrorResponseHandler) => {\n            setErrorSnackMessage(err);\n            setLoadingUsers(false);\n          });\n      } else {\n        setLoadingUsers(false);\n      }\n    }\n  }, [loadingUsers, setErrorSnackMessage, bucketName, displayUsersList]);\n\n  useEffect(() => {\n    if (loadingPolicies) {\n      if (displayPoliciesList) {\n        api\n          .invoke(\"GET\", `/api/v1/bucket-policy/${bucketName}`)\n          .then((res: any) => {\n            setBucketPolicy(res.policies);\n            setLoadingPolicies(false);\n          })\n          .catch((err: ErrorResponseHandler) => {\n            setErrorSnackMessage(err);\n            setLoadingPolicies(false);\n          });\n      } else {\n        setLoadingPolicies(false);\n      }\n    }\n  }, [loadingPolicies, setErrorSnackMessage, bucketName, displayPoliciesList]);\n\n  return (\n    <Fragment>\n      <PanelTitle>Access Audit</PanelTitle>\n      <Tabs\n        value={curTab}\n        onChange={(e: React.ChangeEvent<{}>, newValue: number) => {\n          setCurTab(newValue);\n        }}\n        indicatorColor=\"primary\"\n        textColor=\"primary\"\n        aria-label=\"cluster-tabs\"\n        variant=\"scrollable\"\n        scrollButtons=\"auto\"\n      >\n        {displayPoliciesList && <Tab label=\"Policies\" {...a11yProps(0)} />}\n        {displayUsersList && <Tab label=\"Users\" {...a11yProps(1)} />}\n      </Tabs>\n      <Paper className={classes.tableBlock}>\n        <TabPanel index={0} value={curTab}>\n          <SecureComponent\n            scopes={[IAM_SCOPES.ADMIN_LIST_USER_POLICIES]}\n            resource={bucketName}\n            errorProps={{ disabled: true }}\n          >\n            <TableWrapper\n              noBackground={true}\n              itemActions={PolicyActions}\n              columns={[{ label: \"Name\", elementKey: \"name\" }]}\n              isLoading={loadingPolicies}\n              records={bucketPolicy}\n              entityName=\"Policies\"\n              idField=\"name\"\n            />\n          </SecureComponent>\n        </TabPanel>\n\n        <TabPanel index={1} value={curTab}>\n          <SecureComponent\n            scopes={[\n              IAM_SCOPES.ADMIN_GET_POLICY,\n              IAM_SCOPES.ADMIN_LIST_USERS,\n              IAM_SCOPES.ADMIN_LIST_GROUPS,\n            ]}\n            resource={bucketName}\n            matchAll\n            errorProps={{ disabled: true }}\n          >\n            <TableWrapper\n              noBackground={true}\n              itemActions={userTableActions}\n              columns={[{ label: \"User\", elementKey: \"accessKey\" }]}\n              isLoading={loadingUsers}\n              records={bucketUsers}\n              entityName=\"Users\"\n              idField=\"accessKey\"\n            />\n          </SecureComponent>\n        </TabPanel>\n      </Paper>\n    </Fragment>\n  );\n};\n\nexport default withStyles(styles)(connector(AccessDetails));\n","// This file is part of MinIO Console Server\n// Copyright (c) 2021 MinIO, Inc.\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU Affero General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU Affero General Public License for more details.\n//\n// You should have received a copy of the GNU Affero General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport React from \"react\";\nimport { Theme } from \"@mui/material/styles\";\nimport createStyles from \"@mui/styles/createStyles\";\nimport withStyles from \"@mui/styles/withStyles\";\nimport { IconButtonProps } from \"@mui/material\";\n\nconst styles = (theme: Theme) =>\n  createStyles({\n    root: {\n      padding: 0,\n      margin: 0,\n      fontSize: \".9rem\",\n    },\n  });\n\ninterface IPanelTitle extends IconButtonProps {\n  classes: any;\n  children: any;\n}\n\nconst PanelTitle = ({ classes, children }: IPanelTitle) => {\n  return <h1 className={classes.root}>{children}</h1>;\n};\n\nexport default withStyles(styles)(PanelTitle);\n","// This file is part of MinIO Console Server\n// Copyright (c) 2021 MinIO, Inc.\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU Affero General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU Affero General Public License for more details.\n//\n// You should have received a copy of the GNU Affero General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport React, { Fragment } from \"react\";\n\ninterface TabPanelProps {\n  children?: React.ReactNode;\n  index: any;\n  value: any;\n}\n\nexport const TabPanel = (props: TabPanelProps) => {\n  const { children, value, index, ...other } = props;\n\n  return (\n    <div\n      role=\"tabpanel\"\n      hidden={value !== index}\n      id={`simple-tabpanel-${index}`}\n      aria-labelledby={`simple-tab-${index}`}\n      style={{ marginTop: \"5px\" }}\n      {...other}\n    >\n      {value === index && <Fragment>{children}</Fragment>}\n    </div>\n  );\n};\n"],"names":["connector","connect","state","session","console","loadingBucket","buckets","bucketDetails","bucketInfo","setErrorSnackMessage","a11yProps","index","id","withStyles","theme","createStyles","tableStyles","match","classes","useState","curTab","setCurTab","loadingPolicies","setLoadingPolicies","bucketPolicy","setBucketPolicy","loadingUsers","setLoadingUsers","bucketUsers","setBucketUsers","bucketName","params","displayPoliciesList","hasPermission","IAM_SCOPES","displayUsersList","viewUser","CONSOLE_UI_RESOURCE","viewPolicy","useEffect","PolicyActions","type","disableButtonFunction","onClick","policy","history","IAM_PAGES","name","userTableActions","user","api","then","res","catch","err","policies","Fragment","value","onChange","e","newValue","indicatorColor","textColor","variant","scrollButtons","label","className","tableBlock","scopes","resource","errorProps","disabled","noBackground","itemActions","columns","elementKey","isLoading","records","entityName","idField","matchAll","root","padding","margin","fontSize","children","TabPanel","props","other","role","hidden","style","marginTop"],"sourceRoot":""}